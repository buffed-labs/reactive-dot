---
sidebar_position: 1
---

import Admonition from "@theme/Admonition";
import TabItem from "@theme/TabItem";
import Tabs from "@theme/Tabs";

# Setup

This walks you through the process of creating a simple ReactiveDOT application.

:::tip[Automatic installation]
For new projects, you can quickly set up your ReactiveDOT app using the [`create-polkadot-dapp`](https://github.com/paritytech/create-polkadot-dapp) command line interface (CLI).
This will create a new ReactiveDOT project using TypeScript and install the required dependencies.

```sh npm2yarn
npm create polkadot-dapp@latest
```

:::

## Installation

First add ReactiveDOT, along with required packages as dependencies to your React project.

```sh npm2yarn
npm install @reactive-dot/core @reactive-dot/react polkadot-api
```

### Download & sync metadata

Next, download the latest metadata from the chain you want to connect to and generate the types.

```sh
# `papi add` is the command
# `polkadot_asset_hub` is the name we're giving to this chain (can be any JS variable name)
# `-n polkadot_asset_hub` specifies to download the metadata from the well-known chain polkadot_asset_hub
npx papi add polkadot_asset_hub -n polkadot_asset_hub
# Wait for the latest metadata to download, then generate the types:
npx papi
```

:::tip

It's a really good idea to add `papi` to the "postinstall" script in package.json to automate generating the types after installation.

:::

:::info

For more information on metadata syncing and type generation, please refer to this [documentation](https://papi.how/codegen) provided by [Polkadot-API](https://papi.how/).

:::

### Create config

{/* prettier-ignore-start */}

<Tabs>
  <TabItem value="light-client" label="Light client" default>

{/* prettier-ignore-end */}

```ts title="config.ts"
// `polkadot_asset_hub` is the name we gave to `npx papi add`
import { polkadot_asset_hub } from "@polkadot-api/descriptors";
import { defineConfig } from "@reactive-dot/core";
import { createLightClientProvider } from "@reactive-dot/core/providers/light-client.js";
import { InjectedWalletProvider } from "@reactive-dot/core/wallets.js";

const lightClientProvider = createLightClientProvider();

export const config = defineConfig({
  chains: {
    // Use "asset_hub" as the `ChainId`, this can be any unique string value
    asset_hub: {
      descriptor: polkadot_asset_hub,
      provider: lightClientProvider
        .addRelayChain({ id: "polkadot" })
        .addParachain({ id: "polkadot_asset_hub" }),
    },
  },
  wallets: [new InjectedWalletProvider()],
});

// Register the config for type safety
declare module "@reactive-dot/core" {
  export interface Register {
    config: typeof config;
  }
}
```

<details>
  <summary>Parachains setup</summary>

```ts title="config.ts"
// ...
// highlight-next-line
import {
  polkadot,
  polkadot_asset_hub,
  polkadot_people,
} from "@polkadot-api/descriptors";

const lightClientProvider = createLightClientProvider();

// highlight-next-line
const polkadotProvider = lightClientProvider.addRelayChain({ id: "polkadot" });

export const config = defineConfig({
  chains: {
    // highlight-start
    relay: {
      descriptor: polkadot,
      provider: polkadotProvider,
    },
    asset_hub: {
      descriptor: polkadot_asset_hub,
      provider: polkadotProvider.addParachain({ id: "polkadot_asset_hub" }),
    },
    people: {
      descriptor: polkadot_people,
      provider: polkadotProvider.addParachain({ id: "polkadot_people" }),
    },
    // highlight-end
  },
  wallets: [new InjectedWalletProvider()],
});
```

</details>

{/* prettier-ignore-start */}

  </TabItem>
  <TabItem value="ws" label="WebSocket">

{/* prettier-ignore-end */}

```ts title="config.ts"
// `polkadot_asset_hub` is the name we gave to `npx papi add`
import { polkadot_asset_hub } from "@polkadot-api/descriptors";
import { getWsProvider } from "@polkadot-api/ws-provider";
import { defineConfig } from "@reactive-dot/core";
import { InjectedWalletProvider } from "@reactive-dot/core/wallets.js";

export const config = defineConfig({
  chains: {
    // Use "asset_hub" as the `ChainId`, this can be any unique string value
    asset_hub: {
      descriptor: polkadot_asset_hub,
      provider: getWsProvider("wss://polkadot-asset-hub-rpc.polkadot.io"),
    },
  },
  wallets: [new InjectedWalletProvider()],
});

// Register the config for type safety
declare module "@reactive-dot/core" {
  export interface Register {
    config: typeof config;
  }
}
```

{/* prettier-ignore-start */}

  </TabItem>
</Tabs>

{/* prettier-ignore-end */}

### Wrap app in context providers

```tsx title="app.tsx"
import { config } from "./config";
import { ChainProvider, ReactiveDotProvider } from "@reactive-dot/react";
import { Suspense } from "react";

export function App() {
  return (
    <ReactiveDotProvider config={config}>
      <ChainProvider chainId="asset_hub">
        <Suspense fallback="Loading...">{/* ... */}</Suspense>
      </ChainProvider>
    </ReactiveDotProvider>
  );
}
```

## Use ReactiveDOT

```tsx title="my-component.tsx"
import { config } from "./config";
import { useAccounts, useLazyLoadQuery } from "@reactive-dot/react";

export function MyComponent() {
  const accounts = useAccounts();
  const [timestamp, totalIssuance] = useLazyLoadQuery((builder) =>
    builder.storage("Timestamp", "Now").storage("Balances", "TotalIssuance"),
  );

  return (
    <div>
      <ul>
        {accounts.map((account, index) => (
          <li key={index}>
            <div>Address: {account.address}</div>
            {account.name && <div>Name: {account.name}</div>}
          </li>
        ))}
      </ul>
      <section>
        <div>
          Latest block timestamp: {new Date(Number(timestamp)).toLocaleString()}
        </div>
        <div>Total issuance: {totalIssuance.toString()}</div>
      </section>
    </div>
  );
}
```
